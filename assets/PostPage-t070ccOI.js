import{_ as ce}from"./BPagination.vue_vue_type_script_setup_true_lang-DuwKeY2--sBK1QlUD.js";import{u as be,P as ge,B as ye,_ as ke}from"./ActionsAndComment-DrReJa_G.js";import{d as we,r as C,o as Ce,w as R,a as i,c as d,b as l,e as U,f as V,g as v,v as M,u as o,i as F,h as q,F as B,j as S,t as m,n as Ue,k as Ve,l as x,m as Fe}from"./index-BeFwxGq7.js";import{f as xe,a as Me}from"./postService-CZlftJwb.js";const Be={class:"posts-app"},Se=["value"],Te={class:"posts-control"},Ae={class:"posts-control"},Ee=["value"],De={class:"posts-list"},Ie=["value"],Ne={key:0,class:"bulk-actions"},$e={class:"post-header"},Le={class:"post-user"},_e={key:1,class:"post-body"},je={class:"pagination-container"},ze={key:0,class:"bulk-actions"},Je=we({__name:"PostPage",setup(Oe){let{posts:f,favorites:T,selectedPosts:p,editingPostId:A,editedPost:E,activeComments:G,perPage:r,modalVisible:P,modalTitle:H,modalMessage:J,cancelEditPost:K,deletePost:Q,toggleFavorite:W,handleBulkAction:D,editPost:X,saveEditPost:Y,updatePerPage:c,confirmModalAction:I,cancelModalAction:N,openModal:$,showComments:Z,rows:h,comments:ee,postTitleFilter:b,displayedPosts:te,selectedUsers:g,filterFavorites:oe,updateFilteredPosts:u,sortField:le,sortDirection:se}=be();const L=C(1),_=[10,20,50,100,-1],y=C([]),ne=s=>{g.value.includes(s)?g.value=g.value.filter(e=>e!==s):g.value.push(s),u()},ae=s=>{oe.value=s,u()},ie=s=>{le.value=s,u()},de=s=>{se.value=s,u()},ue=async()=>{f.value=await xe("posts")},re=async()=>{y.value=await Me()},pe=s=>{const e=y.value.find(w=>w.id===s);return e||console.warn(`Пользователь с ID ${s} не найден`),(e==null?void 0:e.name)||"Неизвестный автор"},k=C(!1),a=C({title:"",body:"",userId:null}),ve=()=>{k.value=!0,a.value={title:"",body:"",userId:null}},j=()=>{k.value=!1},me=()=>{if(!a.value.title||!a.value.body||!a.value.userId){alert("Пожалуйста, заполните все поля.");return}const s=Math.max(...f.value.map(e=>e.id),0)+1;f.value.push({id:s,...a.value}),u(),j()};return Ce(()=>{ue(),re(),R(f,u)}),R(r,c),(s,e)=>{const w=ye,fe=ke,Pe=ce;return i(),d("div",Be,[l("div",{class:"posts-control"},[l("button",{onClick:ve},"Добавить новый пост")]),U(w,{modelValue:k.value,"onUpdate:modelValue":e[3]||(e[3]=t=>k.value=t),title:"Добавить новый пост"},{footer:V(()=>[l("button",{onClick:me},"Сохранить"),l("button",{onClick:j},"Отменить")]),default:V(()=>[l("div",null,[e[18]||(e[18]=l("label",{for:"newPostTitle"},"Название поста:",-1)),v(l("input",{id:"newPostTitle","onUpdate:modelValue":e[0]||(e[0]=t=>a.value.title=t),type:"text",placeholder:"Введите название поста"},null,512),[[M,a.value.title]])]),l("div",null,[e[19]||(e[19]=l("label",{for:"newPostBody"},"Текст поста:",-1)),v(l("textarea",{id:"newPostBody","onUpdate:modelValue":e[1]||(e[1]=t=>a.value.body=t),placeholder:"Введите текст поста"},null,512),[[M,a.value.body]])]),l("div",null,[e[20]||(e[20]=l("label",{for:"newPostAuthor"},"Автор поста:",-1)),v(l("select",{id:"newPostAuthor","onUpdate:modelValue":e[2]||(e[2]=t=>a.value.userId=t)},[(i(!0),d(B,null,S(y.value,t=>(i(),d("option",{key:t.id,value:t.id},m(t.name),9,Se))),128))],512),[[q,a.value.userId]])])]),_:1},8,["modelValue"]),l("div",Te,[e[21]||(e[21]=l("label",{class:"header-title",for:"postTitleFilter"},"Фильтр по названию поста:",-1)),v(l("input",{id:"postTitleFilter","onUpdate:modelValue":e[4]||(e[4]=t=>F(b)?b.value=t:b=t),onInput:e[5]||(e[5]=(...t)=>o(u)&&o(u)(...t)),type:"text",placeholder:"Введите часть названия поста"},null,544),[[M,o(b)]])]),l("div",Ae,[e[22]||(e[22]=l("label",{class:"header-title",for:"perPageSelect"},"Количество постов на странице:",-1)),v(l("select",{id:"perPageSelect","onUpdate:modelValue":e[6]||(e[6]=t=>F(r)?r.value=t:r=t),onChange:e[7]||(e[7]=(...t)=>o(c)&&o(c)(...t))},[(i(),d(B,null,S(_,t=>l("option",{key:t,value:t},m(t===-1?"Все":t),9,Ee)),64))],544),[[q,o(r),void 0,{number:!0}]])]),U(fe,{perPageOptions:_,users:y.value,onUpdatePerPage:o(c),onUpdateSelectedUsers:ne,onUpdateFilterFavorites:ae,onUpdateSortField:ie,onUpdateSortDirection:de},null,8,["users","onUpdatePerPage"]),l("ul",De,[(i(!0),d(B,null,S(o(te),t=>{var z,O;return i(),d("li",{key:t.id,class:Ue(["post-item",{"favorite-post":o(T).includes(t.id)}])},[v(l("input",{type:"checkbox",value:t.id,"onUpdate:modelValue":e[8]||(e[8]=n=>F(p)?p.value=n:p=n),class:"select-post"},null,8,Ie),[[Ve,o(p)]]),o(p).includes(t.id)?(i(),d("div",Ne,[l("button",{onClick:e[9]||(e[9]=n=>o($)("delete"))},"Удалить выбранные"),l("button",{onClick:e[10]||(e[10]=n=>o($)("favorite"))},"Добавить в избранное")])):x("",!0),U(w,{modelValue:o(P),"onUpdate:modelValue":e[13]||(e[13]=n=>F(P)?P.value=n:P=n),title:o(H)},{footer:V(()=>[l("button",{onClick:e[11]||(e[11]=(...n)=>o(I)&&o(I)(...n))},"Подтвердить"),l("button",{onClick:e[12]||(e[12]=(...n)=>o(N)&&o(N)(...n))},"Отменить")]),default:V(()=>[l("p",null,m(o(J)),1)]),_:1},8,["modelValue","title"]),l("div",$e,[l("h3",null,m(t.title),1),l("p",Le,"Автор: "+m(pe(t.userId)),1)]),o(A)!==t.id?(i(),d("p",_e,m(t.body),1)):x("",!0),U(ge,{post:t,"active-comments":o(G),"editing-post-id":o(A),favorites:o(T),"post-comments":((z=o(ee).find(n=>n.postId===t.id))==null?void 0:z.comments)||[],"edited-body":(O=o(E))==null?void 0:O.body,onUpdateEditedBody:e[14]||(e[14]=n=>o(E).body=n),onToggleComments:o(Z),onSaveEdit:o(Y),onCancelEdit:o(K),onEditPost:o(X),onDeletePost:o(Q),onToggleFavorite:o(W)},null,8,["post","active-comments","editing-post-id","favorites","post-comments","edited-body","onToggleComments","onSaveEdit","onCancelEdit","onEditPost","onDeletePost","onToggleFavorite"])],2)}),128))]),l("div",je,[o(r)!==-1?(i(),Fe(Pe,{key:0,modelValue:L.value,"onUpdate:modelValue":e[15]||(e[15]=t=>L.value=t),"total-rows":o(h),"per-page":o(r),"first-text":"First","prev-text":"Prev","next-text":"Next","last-text":"Last"},null,8,["modelValue","total-rows","per-page"])):x("",!0)]),o(p).length>0?(i(),d("div",ze,[l("button",{onClick:e[16]||(e[16]=t=>o(D)("delete"))},"Удалить выбранные"),l("button",{onClick:e[17]||(e[17]=t=>o(D)("favorite"))},"Добавить в избранное")])):x("",!0)])}}});export{Je as default};
