import{_ as E}from"./BPagination.vue_vue_type_script_setup_true_lang-DuwKeY2--CW0wn2lH.js";import{r as d,s as c,o as N,c as i,b as l,g as s,h as x,F as k,j as T,v as g,m as O,l as j,a as u,t as C,k as _,ai as B}from"./index-BhM-hwZ3.js";import{c as Q}from"./postService-riRPQZvn.js";const q={class:"posts-control"},z=["value"],A={class:"filter-sort"},G={class:"add-task"},H={class:"tasks-columns"},J={class:"column"},R=["onUpdate:modelValue"],W=["onUpdate:modelValue","onBlur","onKeyup"],X={key:1},Y=["onClick"],Z=["onUpdate:modelValue"],ee={class:"column"},te=["onUpdate:modelValue"],le=["onUpdate:modelValue","onBlur","onKeyup"],oe={key:1,class:"completed"},ne=["onClick"],ae=["onUpdate:modelValue"],se={class:"pagination-container"},ce={__name:"Task",setup(ue){const a=d(parseInt(localStorage.getItem("todoPage")||"10",10)),p=d(1),r=d([]),S=[10,20,50,100,-1],y=d(""),m=d("all"),V=d("asc"),v=d(""),$=async()=>{try{r.value=await Q(),r.value.forEach(o=>{o.selected=!1,o.editing=!1})}catch(o){console.error("Ошибка при загрузке задач:",o)}},h=c(()=>{let o=r.value.filter(t=>t.title.toLowerCase().includes(y.value.toLowerCase()));return m.value==="incomplete"?o=o.filter(t=>!t.completed):m.value==="complete"&&(o=o.filter(t=>t.completed)),o.sort((t,U)=>{const e=t.title.localeCompare(U.title);return V.value==="asc"?e:-e})}),b=c(()=>h.value.filter(o=>!o.completed)),P=c(()=>h.value.filter(o=>o.completed)),K=c(()=>h.value.length),F=c(()=>{if(a.value===-1)return b.value;const o=(p.value-1)*a.value,t=o+a.value;return b.value.slice(o,t)}),I=c(()=>{if(a.value===-1)return P.value;const o=(p.value-1)*a.value,t=o+a.value;return P.value.slice(o,t)}),L=()=>{localStorage.setItem("todoPage",a.value.toString()),p.value=1},M=()=>{v.value.trim()&&(r.value.push({id:Date.now(),title:v.value,completed:!1,selected:!1,editing:!1}),v.value="")},w=o=>{o.editing=!0},f=o=>{o.editing=!1},D=()=>{r.value=r.value.filter(o=>!o.selected)};return N($),(o,t)=>{const U=E;return u(),i("div",null,[l("div",q,[t[6]||(t[6]=l("label",{class:"header-title",for:"perPageSelect"},"Количество задач на странице:",-1)),s(l("select",{id:"perPageSelect","onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),onChange:L},[(u(),i(k,null,T(S,e=>l("option",{key:e,value:e},C(e===-1?"Все":e),9,z)),64))],544),[[x,a.value,void 0,{number:!0}]])]),l("div",A,[s(l("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>y.value=e),type:"text",placeholder:"Поиск задач",class:"search-input"},null,512),[[g,y.value]]),s(l("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>m.value=e)},t[7]||(t[7]=[l("option",{value:"all"},"Все",-1),l("option",{value:"incomplete"},"Невыполненные",-1),l("option",{value:"complete"},"Выполненные",-1)]),512),[[x,m.value]]),s(l("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>V.value=e)},t[8]||(t[8]=[l("option",{value:"asc"},"По возрастанию",-1),l("option",{value:"desc"},"По убыванию",-1)]),512),[[x,V.value]])]),l("div",G,[s(l("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>v.value=e),type:"text",placeholder:"Введите название задачи"},null,512),[[g,v.value]]),l("button",{onClick:M},"Добавить задачу")]),l("div",H,[l("div",J,[t[9]||(t[9]=l("h3",null,"Невыполненные задачи",-1)),l("ul",null,[(u(!0),i(k,null,T(F.value,e=>(u(),i("li",{key:e.id},[s(l("input",{type:"checkbox","onUpdate:modelValue":n=>e.selected=n},null,8,R),[[_,e.selected]]),e.editing?s((u(),i("input",{key:0,"onUpdate:modelValue":n=>e.title=n,onBlur:n=>f(e),onKeyup:B(n=>f(e),["enter"])},null,40,W)),[[g,e.title]]):(u(),i("span",X,C(e.title),1)),l("button",{onClick:n=>w(e)},"Редактировать",8,Y),s(l("input",{type:"checkbox","onUpdate:modelValue":n=>e.completed=n},null,8,Z),[[_,e.completed]])]))),128))])]),l("div",ee,[t[10]||(t[10]=l("h3",null,"Выполненные задачи",-1)),l("ul",null,[(u(!0),i(k,null,T(I.value,e=>(u(),i("li",{key:e.id},[s(l("input",{type:"checkbox","onUpdate:modelValue":n=>e.selected=n},null,8,te),[[_,e.selected]]),e.editing?s((u(),i("input",{key:0,"onUpdate:modelValue":n=>e.title=n,onBlur:n=>f(e),onKeyup:B(n=>f(e),["enter"])},null,40,le)),[[g,e.title]]):(u(),i("span",oe,C(e.title),1)),l("button",{onClick:n=>w(e)},"Редактировать",8,ne),s(l("input",{type:"checkbox","onUpdate:modelValue":n=>e.completed=n},null,8,ae),[[_,e.completed]])]))),128))])])]),l("button",{onClick:D},"Удалить выбранные задачи"),l("div",se,[a.value!==-1?(u(),O(U,{key:0,modelValue:p.value,"onUpdate:modelValue":t[5]||(t[5]=e=>p.value=e),"total-rows":K.value,"per-page":a.value,"first-text":"First","prev-text":"Prev","next-text":"Next","last-text":"Last"},null,8,["modelValue","total-rows","per-page"])):j("",!0)])])}}};export{ce as default};
